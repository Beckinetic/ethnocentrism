head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
# Plot for gamma
plot_types_majority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_W, "W", "Averaged Over W and Minority Proportion")
# Plot for minority proportion
plot_types_majority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
# Prepare data for MANOVA using relevant columns
manova_data <- data_raw %>%
select(gamma, W, minorityproportion, altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority,
altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority)
# Run MANOVA
manova_results <- manova(cbind(altruistmajority, egoistmajority, altruistminority, egoistminority) ~ gamma * W * minorityproportion,
data = manova_data)
# Summary of MANOVA results
summary(manova_results)
# Alternatively, individual linear regression models for each outcome
# summary(lm(altruistmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(ethnocentristmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(cosmopolitanmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(egoistmajority ~ gamma * W * minorityproportion, data = manova_data))
library(dplyr)
data_raw <- read.csv('../data/ethnocentrism-proj experiment-no-perturbation-table.csv',skip=6)
# rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
colnames(data_raw)
library(dplyr)
average_data <- data_raw %>%
group_by(gamma, W, minorityproportion) %>%
summarise(avg_altruist_majority = mean(altruistmajority),
avg_ethnocentrist_majority = mean(ethnocentristmajority),
avg_cosmopolitan_majority = mean(cosmopolitanmajority),
avg_egoist_majority = mean(egoistmajority),
avg_altruist_minority = mean(altruistminority),
avg_ethnocentrist_minority = mean(ethnocentristminority),
avg_cosmopolitan_minority = mean(cosmopolitanminority),
avg_egoist_minority = mean(egoistminority),
avg_altruist_all = mean(altruistmajority + altruistminority),
avg_ethnocentrist_all = mean(ethnocentristmajority + ethnocentristminority),
avg_cosmopolitan_all = mean(cosmopolitanmajority + cosmopolitanminority),
avg_egoist_all = mean(egoistmajority + egoistminority))
head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_W, "W", "Averaged Over W and Minority Proportion")
# Plot for minority proportion
plot_types_majority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
# Prepare data for MANOVA using relevant columns
manova_data <- data_raw %>%
select(gamma, W, minorityproportion, altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority,
altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority)
# Run MANOVA
manova_results <- manova(cbind(altruistmajority, egoistmajority, altruistminority, egoistminority) ~ gamma * W * minorityproportion,
data = manova_data)
# Summary of MANOVA results
summary(manova_results)
# Alternatively, individual linear regression models for each outcome
# summary(lm(altruistmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(ethnocentristmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(cosmopolitanmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(egoistmajority ~ gamma * W * minorityproportion, data = manova_data))
library(dplyr)
data_raw <- read.csv('../data/ethnocentrism-proj experiment-no-perturbation-new-strategies-table.csv',skip=6)
# rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
colnames(data_raw)
library(dplyr)
average_data <- data_raw %>%
group_by(gamma, W, minorityproportion) %>%
summarise(avg_altruist_majority = mean(altruistmajority),
avg_ethnocentrist_majority = mean(ethnocentristmajority),
avg_cosmopolitan_majority = mean(cosmopolitanmajority),
avg_egoist_majority = mean(egoistmajority),
avg_altruist_minority = mean(altruistminority),
avg_ethnocentrist_minority = mean(ethnocentristminority),
avg_cosmopolitan_minority = mean(cosmopolitanminority),
avg_egoist_minority = mean(egoistminority),
avg_altruist_all = mean(altruistmajority + altruistminority),
avg_ethnocentrist_all = mean(ethnocentristmajority + ethnocentristminority),
avg_cosmopolitan_all = mean(cosmopolitanmajority + cosmopolitanminority),
avg_egoist_all = mean(egoistmajority + egoistminority))
head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_W, "W", "Averaged Over W and Minority Proportion")
# Plot for minority proportion
plot_types_majority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
# Prepare data for MANOVA using relevant columns
manova_data <- data_raw %>%
select(gamma, W, minorityproportion, altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority,
altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority)
# Run MANOVA
manova_results <- manova(cbind(altruistmajority, egoistmajority, altruistminority, egoistminority) ~ gamma * W * minorityproportion,
data = manova_data)
# Summary of MANOVA results
summary(manova_results)
# Alternatively, individual linear regression models for each outcome
# summary(lm(altruistmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(ethnocentristmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(cosmopolitanmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(egoistmajority ~ gamma * W * minorityproportion, data = manova_data))
library(dplyr)
data_raw <- read.csv('../data/ethnocentrism-proj experiment-with-perturbation-table.csv',skip=6)
# rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
colnames(data_raw)
library(dplyr)
average_data <- data_raw %>%
group_by(gamma, W, minorityproportion) %>%
summarise(avg_altruist_majority = mean(altruistmajority),
avg_ethnocentrist_majority = mean(ethnocentristmajority),
avg_cosmopolitan_majority = mean(cosmopolitanmajority),
avg_egoist_majority = mean(egoistmajority),
avg_altruist_minority = mean(altruistminority),
avg_ethnocentrist_minority = mean(ethnocentristminority),
avg_cosmopolitan_minority = mean(cosmopolitanminority),
avg_egoist_minority = mean(egoistminority),
avg_altruist_all = mean(altruistmajority + altruistminority),
avg_ethnocentrist_all = mean(ethnocentristmajority + ethnocentristminority),
avg_cosmopolitan_all = mean(cosmopolitanmajority + cosmopolitanminority),
avg_egoist_all = mean(egoistmajority + egoistminority))
head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_W, "W", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_W, "W", "Averaged Over W and Minority Proportion")
library(dplyr)
average_data <- data_raw %>%
group_by(gamma, W, minorityproportion) %>%
summarise(avg_altruist_majority = mean(altruistmajority),
avg_ethnocentrist_majority = mean(ethnocentristmajority),
avg_cosmopolitan_majority = mean(cosmopolitanmajority),
avg_egoist_majority = mean(egoistmajority),
avg_altruist_minority = mean(altruistminority),
avg_ethnocentrist_minority = mean(ethnocentristminority),
avg_cosmopolitan_minority = mean(cosmopolitanminority),
avg_egoist_minority = mean(egoistminority),
avg_altruist_all = mean(altruistmajority + altruistminority),
avg_ethnocentrist_all = mean(ethnocentristmajority + ethnocentristminority),
avg_cosmopolitan_all = mean(cosmopolitanmajority + cosmopolitanminority),
avg_egoist_all = mean(egoistmajority + egoistminority))
head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for minority proportion
plot_types_majority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_minorityprop, "minorityproportion", "Averaged Over W and Minority Proportion")
# Prepare data for MANOVA using relevant columns
manova_data <- data_raw %>%
select(gamma, W, minorityproportion, altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority,
altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority)
# Run MANOVA
manova_results <- manova(cbind(altruistmajority, egoistmajority, altruistminority, egoistminority) ~ gamma * W * minorityproportion,
data = manova_data)
# Summary of MANOVA results
summary(manova_results)
# Alternatively, individual linear regression models for each outcome
# summary(lm(altruistmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(ethnocentristmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(cosmopolitanmajority ~ gamma * W * minorityproportion, data = manova_data))
# summary(lm(egoistmajority ~ gamma * W * minorityproportion, data = manova_data))
library(dplyr)
data_raw <- read.csv('../data/ethnocentrism-proj experiment-no-perturbation-table.csv',skip=6)
# rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
colnames(data_raw)
library(dplyr)
average_data <- data_raw %>%
group_by(gamma, W, minorityproportion) %>%
summarise(avg_altruist_majority = mean(altruistmajority),
avg_ethnocentrist_majority = mean(ethnocentristmajority),
avg_cosmopolitan_majority = mean(cosmopolitanmajority),
avg_egoist_majority = mean(egoistmajority),
avg_altruist_minority = mean(altruistminority),
avg_ethnocentrist_minority = mean(ethnocentristminority),
avg_cosmopolitan_minority = mean(cosmopolitanminority),
avg_egoist_minority = mean(egoistminority),
avg_altruist_all = mean(altruistmajority + altruistminority),
avg_ethnocentrist_all = mean(ethnocentristmajority + ethnocentristminority),
avg_cosmopolitan_all = mean(cosmopolitanmajority + cosmopolitanminority),
avg_egoist_all = mean(egoistmajority + egoistminority))
head(average_data)
library(ggplot2)
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_minorityprop <- data_raw %>%
group_by(minorityproportion) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
# Define a function to create the plot for each x-axis parameter
plot_types_majority <- function(data, x_var, title_suffix) {
# Majority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
# Minority group plot
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
# Combined group plot (all)
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
setwd("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis")
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
