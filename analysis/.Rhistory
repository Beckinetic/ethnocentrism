mutate(
max_value = max(altruist, ethnocentrist, cosmopolitan, egoist, undefined),
dominant_type = case_when(
max_value == altruist ~ "Altruist",
max_value == ethnocentrist ~ "Ethnocentrist",
max_value == cosmopolitan ~ "Cosmopolitan",
max_value == egoist ~ "Egoist",
max_value == undefined ~ "Undefined"
),
dominance_level = max_value / (altruist + ethnocentrist + cosmopolitan + egoist + undefined)
)
# plot all
ggplot(dominance_data, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (All Groups)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# majority group
ggplot(dominance_data_majority, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (Majority)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# minority group
ggplot(dominance_data_minority, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (Minority)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# Define the plotting functions with consistent color schemes
plot_types_majority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W and Minority Proportion")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over Gamma and Minority Proportion")
plot_types_minority(average_data_W, "W", "Averaged Over Gamma and Minority Proportion")
plot_types_all(average_data_W, "W", "Averaged Over Gamma and Minority Proportion")
# Define the plotting functions with consistent color schemes
plot_types_majority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over Gamma")
plot_types_minority(average_data_W, "W", "Averaged Over Gamma")
plot_types_all(average_data_W, "W", "Averaged Over Gamma")
# Prepare data for MANOVA using relevant columns
manova_data <- data_raw %>%
select(gamma, W, minorityproportion,
altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority,
altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority)
# Combined group MANOVA (majority + minority)
manova_data$altruistall <- manova_data$altruistmajority + manova_data$altruistminority
manova_data$ethnocentristall <- manova_data$ethnocentristmajority + manova_data$ethnocentristminority
manova_data$cosmopolitanall <- manova_data$cosmopolitanmajority + manova_data$cosmopolitanminority
manova_data$egoistall <- manova_data$egoistmajority + manova_data$egoistminority
# Run MANOVA for All Groups (Combined)
manova_results_all <- manova(cbind(altruistall, ethnocentristall, cosmopolitanall, egoistall) ~ gamma * W, data = manova_data)
summary(manova_results_all)
# Run MANOVA for Majority Group
manova_results_majority <- manova(cbind(altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority) ~ gamma * W, data = manova_data)
summary(manova_results_majority)
# Run MANOVA for Minority Group
manova_results_minority <- manova(cbind(altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority) ~ gamma * W, data = manova_data)
summary(manova_results_minority)
summary(manova_results_minority)
file_name
plot_types <- function(data, x_var, group, title_suffix, file_name) {
plot <- ggplot(data, aes_string(x = x_var)) +
geom_line(aes_string(y = paste0("avg_altruist", group), color = "'Altruist'")) +
geom_line(aes_string(y = paste0("avg_ethnocentrist", group), color = "'Ethnocentrist'")) +
geom_line(aes_string(y = paste0("avg_cosmopolitan", group), color = "'Cosmopolitan'")) +
geom_line(aes_string(y = paste0("avg_egoist", group), color = "'Egoist'")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types -", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
# Save the plot
ggsave(file_name, plot = plot, width = 8, height = 6)
}
wd
cwd
getwd()
# Load necessary libraries
library(dplyr)
# Load necessary libraries
library(dplyr)
library(ggplot2)
# Step 1: Data Import and Column Renaming
data_raw <- read.csv('../data/ethnocentrism-proj experiment-baseline-table.csv', skip=6)
# Rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
# Combined group data for Facet Plot
dominance_data <- data_raw %>%
group_by(gamma, W) %>%
summarise(
altruist = mean(altruistmajority + altruistminority),
ethnocentrist = mean(ethnocentristmajority + ethnocentristminority),
cosmopolitan = mean(cosmopolitanmajority + cosmopolitanminority),
egoist = mean(egoistmajority + egoistminority),
undefined = mean(undefinedmajority + undefinedminority)
) %>%
rowwise() %>%
mutate(
max_value = max(altruist, ethnocentrist, cosmopolitan, egoist, undefined),
dominant_type = case_when(
max_value == altruist ~ "Altruist",
max_value == ethnocentrist ~ "Ethnocentrist",
max_value == cosmopolitan ~ "Cosmopolitan",
max_value == egoist ~ "Egoist",
max_value == undefined ~ "Undefined"
),
dominance_level = max_value / (altruist + ethnocentrist + cosmopolitan + egoist + undefined)
)
# Facet Plot
facet_plot <- ggplot(dominance_data, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type - All Groups",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# Save Facet Plot
ggsave("facet_plot_all_groups.png", plot = facet_plot, width = 8, height = 6)
# Average data over gamma and W
average_data_gamma <- data_raw %>%
group_by(gamma) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
average_data_W <- data_raw %>%
group_by(W) %>%
summarise(across(altruistmajority:egoistminority, mean, .names = "avg_{col}"))
plot_types <- function(data, x_var, group, title_suffix, file_name) {
plot <- ggplot(data, aes_string(x = x_var)) +
geom_line(aes_string(y = paste0("avg_altruist", group), color = "'Altruist'")) +
geom_line(aes_string(y = paste0("avg_ethnocentrist", group), color = "'Ethnocentrist'")) +
geom_line(aes_string(y = paste0("avg_cosmopolitan", group), color = "'Cosmopolitan'")) +
geom_line(aes_string(y = paste0("avg_egoist", group), color = "'Egoist'")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types -", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
# Save the plot
ggsave(file_name, plot = plot, width = 8, height = 6)
}
# Plot and save for Gamma
plot_types(average_data_gamma, "gamma", "majority", "Majority Group Averaged Over W and Minority Proportion", "line_plot_majority_gamma.png")
plot_types(average_data_gamma, "gamma", "minority", "Minority Group Averaged Over W and Minority Proportion", "line_plot_minority_gamma.png")
plot_types(average_data_gamma, "gamma", "all", "All Groups Averaged Over W and Minority Proportion", "line_plot_all_gamma.png")
# Plot and save for W
plot_types(average_data_W, "W", "majority", "Majority Group Averaged Over Gamma and Minority Proportion", "line_plot_majority_W.png")
plot_types(average_data_W, "W", "minority", "Minority Group Averaged Over Gamma and Minority Proportion", "line_plot_minority_W.png")
plot_types(average_data_W, "W", "all", "All Groups Averaged Over Gamma and Minority Proportion", "line_plot_all_W.png")
# Combined group variables for MANOVA
manova_data <- data_raw %>%
mutate(
altruistall = altruistmajority + altruistminority,
ethnocentristall = ethnocentristmajority + ethnocentristminority,
cosmopolitanall = cosmopolitanmajority + cosmopolitanminority,
egoistall = egoistmajority + egoistminority
)
# MANOVA for Combined Group
manova_results_all <- manova(cbind(altruistall, ethnocentristall, cosmopolitanall, egoistall) ~ gamma * W, data = manova_data)
summary(manova_results_all)
# MANOVA for Majority Group
manova_results_majority <- manova(cbind(altruistmajority, ethnocentristmajority, cosmopolitanmajority, egoistmajority) ~ gamma * W, data = manova_data)
summary(manova_results_majority)
# MANOVA for Minority Group
manova_results_minority <- manova(cbind(altruistminority, ethnocentristminority, cosmopolitanminority, egoistminority) ~ gamma * W, data = manova_data)
summary(manova_results_minority)
setwd("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis")
run baseline.R
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
summary(manova_results_majority)
summary(manova_results_all)
summary(manova_results_minority)
source("~/.active-rstudio-document", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_perturbation.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_copy.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
library(dplyr)
data_raw <- read.csv('../data/ethnocentrism-proj experiment-with-perturbation-xaver-table.csv',skip=6)
# rename columns for simplicity
colnames(data_raw) <- colnames(data_raw) %>%
gsub("count\\.turtles\\.with\\.\\.type\\.agent\\.\\.\\.\\.|\\.\\.and\\.tag\\.\\.\\.", "", .) %>%
gsub("Altruist", "altruist", .) %>%
gsub("Ethnocentrist", "ethnocentrist", .) %>%
gsub("Cosmopolitan", "cosmopolitan", .) %>%
gsub("Egoist", "egoist", .) %>%
gsub("Undefined", "undefined", .) %>%
gsub("majority", "majority", .) %>%
gsub("minority", "minority", .) %>%
gsub("\\.", "", .)
colnames(data_raw)
library(ggplot2)
# all
dominance_data <- data_raw %>%
group_by(gamma, W) %>%
summarise(
altruist = mean(altruistmajority + altruistminority),
ethnocentrist = mean(ethnocentristmajority + ethnocentristminority),
cosmopolitan = mean(cosmopolitanmajority + cosmopolitanminority),
egoist = mean(egoistmajority + egoistminority),
undefined = mean(undefinedmajority + undefinedminority)
) %>%
rowwise() %>%
mutate(
max_value = max(altruist, ethnocentrist, cosmopolitan, egoist, undefined),
dominant_type = case_when(
max_value == altruist ~ "Altruist",
max_value == ethnocentrist ~ "Ethnocentrist",
max_value == cosmopolitan ~ "Cosmopolitan",
max_value == egoist ~ "Egoist",
max_value == undefined ~ "Undefined"
),
dominance_level = max_value / (altruist + ethnocentrist + cosmopolitan + egoist + undefined)
)
# majority
dominance_data_majority <- data_raw %>%
group_by(gamma, W) %>%
summarise(
altruist = mean(altruistmajority),
ethnocentrist = mean(ethnocentristmajority),
cosmopolitan = mean(cosmopolitanmajority),
egoist = mean(egoistmajority),
undefined = mean(undefinedmajority)
) %>%
rowwise() %>%
mutate(
max_value = max(altruist, ethnocentrist, cosmopolitan, egoist, undefined),
dominant_type = case_when(
max_value == altruist ~ "Altruist",
max_value == ethnocentrist ~ "Ethnocentrist",
max_value == cosmopolitan ~ "Cosmopolitan",
max_value == egoist ~ "Egoist",
max_value == undefined ~ "Undefined"
),
dominance_level = max_value / (altruist + ethnocentrist + cosmopolitan + egoist + undefined)
)
# minority
dominance_data_minority <- data_raw %>%
group_by(gamma, W) %>%
summarise(
altruist = mean(altruistminority),
ethnocentrist = mean(ethnocentristminority),
cosmopolitan = mean(cosmopolitanminority),
egoist = mean(egoistminority),
undefined = mean(undefinedminority)
) %>%
rowwise() %>%
mutate(
max_value = max(altruist, ethnocentrist, cosmopolitan, egoist, undefined),
dominant_type = case_when(
max_value == altruist ~ "Altruist",
max_value == ethnocentrist ~ "Ethnocentrist",
max_value == cosmopolitan ~ "Cosmopolitan",
max_value == egoist ~ "Egoist",
max_value == undefined ~ "Undefined"
),
dominance_level = max_value / (altruist + ethnocentrist + cosmopolitan + egoist + undefined)
)
# plot all
ggplot(dominance_data, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (All Groups)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# majority group
ggplot(dominance_data_majority, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (Majority)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# minority group
ggplot(dominance_data_minority, aes(x = gamma, y = W)) +
geom_tile(aes(fill = dominant_type, alpha = dominance_level)) +
geom_text(aes(label = round(dominance_level * 100, 0)), color = "black", size = 3) +
scale_fill_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange",
"Undefined" = "darkgrey")) +
scale_alpha_continuous(name = "Proportion (%)", range = c(0.2, 1), labels = scales::percent_format(accuracy = 1)) +
labs(title = "Final Dominant Agent Type (Minority)",
x = "Gamma", y = "W", fill = "Dominant Type") +
theme_minimal() +
theme(panel.grid = element_blank()) +
coord_fixed()
# Define the plotting functions with consistent color schemes
plot_types_majority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Majority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_minority <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - Minority", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
plot_types_all <- function(data, x_var, title_suffix) {
ggplot(data, aes_string(x = x_var)) +
geom_line(aes(y = avg_altruistmajority + avg_altruistminority, color = "Altruist")) +
geom_line(aes(y = avg_ethnocentristmajority + avg_ethnocentristminority, color = "Ethnocentrist")) +
geom_line(aes(y = avg_cosmopolitanmajority + avg_cosmopolitanminority, color = "Cosmopolitan")) +
geom_line(aes(y = avg_egoistmajority + avg_egoistminority, color = "Egoist")) +
scale_color_manual(values = c("Altruist" = "green",
"Ethnocentrist" = "yellow",
"Cosmopolitan" = "blue",
"Egoist" = "orange")) +
labs(title = paste("Effect of", x_var, "on Agent Types - All", title_suffix),
x = x_var, y = "Number of Agents", color = "Agent Type") +
theme_minimal()
}
# Plot for gamma
plot_types_majority(average_data_gamma, "gamma", "Averaged Over W")
plot_types_minority(average_data_gamma, "gamma", "Averaged Over W")
plot_types_all(average_data_gamma, "gamma", "Averaged Over W")
# Plot for W
plot_types_majority(average_data_W, "W", "Averaged Over Gamma")
plot_types_minority(average_data_W, "W", "Averaged Over Gamma")
plot_types_all(average_data_W, "W", "Averaged Over Gamma")
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_baseline.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-Personal/ResMasPsych/1-CourseFiles/Complexity Science/Group Project/ethnocentrism/analysis/stat_likeness.R", echo=TRUE)
